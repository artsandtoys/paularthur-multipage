<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hi i'm paul</title>
    <link rel="icon" href="images/tinyguru3-10px_small.png" type="image/png">

<style>
/* -------------------------------------- */
/* BASE STYLES */
/* -------------------------------------- */
body {
    background-color: #000;
    color: #fff;
    font-family: Helvetica, Arial, sans-serif;
    font-size: 16px;
    margin: 0;
    padding: 0;
    display: flex;
    min-height: 100vh;
    box-sizing: border-box;
}

h1, h2 {
    margin-top: 0;
    margin-bottom: 0;
}

/* MAIN CONTAINER */
.main-container {
    width: 75%;
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    flex-grow: 1;
    padding-bottom: 50px;
    align-items: flex-start;
}

/* LEFT COLUMN (STICKY NAV) */
.left-column {
    flex-basis: 33.33%;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    position: sticky;
    top: 0;
    height: 90vh;
    padding-right: 20px;
    box-sizing: border-box;
}

.left-content {
    width: 75%;
    margin-top: 14vh;
}

.left-content h1, .left-content h2 {
    margin: 0;
}

.description-text {
    color: #ddd;
    font-size: 16px;
    font-weight: normal;
    line-height: 1.5;
    margin-top: 16px;
    margin-bottom: 16px;
}

/* LEFT NAV LINKS */
.left-content nav a {
    color: #fff;
    text-decoration: none;
    display: block;
    margin: 10px 0;
    padding: 5px 0px;
    transition: color 0.3s;
}

.left-content nav a:hover {
    color: #b3ff00;
}

.left-content nav a.active {
    color: #b3ff00;
    font-weight: bold;
}

/* RIGHT COLUMN (Content area where new files are loaded) */
.right-column-wrapper {
    flex-basis: 66.66%;
    flex-grow: 1;
    margin-top: 0.5vh;
    padding-top: 16vh;
    padding-left: 20px;
    box-sizing: border-box;
    position: relative;
    /* Since content is replaced, overflow-y is not strictly needed here, 
       but if loaded content is long, it should scroll the document or the wrapper. 
       Let's assume document scroll for simplicity if content exceeds viewport. 
       If you want *only* the right column to scroll, you must define a fixed height for it. 
       We'll keep the current approach for now. */
}

.right-column-wrapper h2 {
    margin: 0 0 8px 0;
}

/* Base styles for content loaded into the right column */
.content-section p {
    color: #ddd;
    line-height: 1.5;
    margin-bottom: 16px;
}

.content-section {
    padding: 32px 0;
}

/* TIMELINE (These styles must be present in the main CSS, even if used in works.html) */
.timeline {
    position: relative;
    padding: 20px 0 2px 30px;
}

.timeline::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 2px;
    background: #444;
}

.timeline-item-link {
    position: relative;
    display: block;
    margin-bottom: 30px;
    padding: 0 0 0 20px;
    text-decoration: none;
    color: #fff;
    transition: color 0.3s ease;
}

.timeline-item-link:hover {
    color: #22cc33;
    cursor: pointer;
}

.timeline-item-link::before {
    content: '';
    position: absolute;
    left: -10px;
    top: 5px;
    width: 8px;
    height: 8px;
    background: #b3ff00;
    border-radius: 50%;
    z-index: 1;
}

.timeline-date {
    color: #ccc;
}

/* POPUP GALLERY (These styles must be present in the main CSS) */
#columnPopup {
    position: fixed; /* Use fixed since it covers the entire viewport */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.9); /* Darker background for focus */
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999; 
    cursor: pointer;
}

#columnPopup img,
#columnPopup video { /* Apply styles to both img and video */
    max-width: 90%; 
    max-height: 90%;
    box-shadow: 0 0 20px rgba(0,0,0,0.8);
    object-fit: contain;
    opacity: 1; /* Ensure full visibility */
    transition: opacity 0.3s ease;
    cursor: default; /* Change cursor on media */
}

.gallery-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: #fff;
    font-size: 2em;
    cursor: pointer;
    padding: 20px;
    user-select: none;
    z-index: 10000;
}

#prevBtn { left: 30px; }
#nextBtn { right: 30px; }

.gallery-btn:hover {
    color: #b3ff00;
}

/* -------------------------------------- */
/* MOBILE RESPONSIVE */
/* -------------------------------------- */
@media (max-width: 800px) {
    .main-container {
        width: 84%;
        flex-direction: column;
        margin: 0px 4px;
    }

    .left-column {
        position: static;
        width: 100%;
        padding-right: 0;
        justify-content: flex-start;
        align-items: flex-start;
        height: auto; /* Remove fixed height on mobile */
    }

    .left-content {
        width: 100%;
        text-align: left;
        margin-top: 0;
        padding-top: 0;
    }

    .left-content nav a {
        display: inline-block;
        margin: 0 10px 10px 0; /* Inline links with spacing */
    }

    .right-column-wrapper {
        flex-basis: 100%;
        padding-left: 0;
        padding-top: 0;
    }
}

@media (max-width: 600px) {
    .gallery-btn {
        font-size: 2em;
        padding: 10px;
    }
    #prevBtn { left: 5px; }
    #nextBtn { right: 5px; }
}

</style>
</head>

<body>

<div class="main-container">

    <div class="left-column">
        <div class="left-content">
            <h1>Paul Arthur</h1>
            <br>
            <h2>Creative Technologist</h2>

            <div class="description-text">
                Audio / Visual Artist and Storyteller
            </div>

            <nav>
                <a href="#" class="nav-link" data-content-file="about.html">about &ensp;</a>
                <a href="#" class="nav-link" data-content-file="works.html">works &ensp;</a>
            </nav>
        </div>
    </div>

    <div class="right-column-wrapper">
        <p>Loading content...</p>
    </div>
</div>
    
<script>
document.addEventListener('DOMContentLoaded', () => {

    const rightColumn = document.querySelector('.right-column-wrapper');
    const navLinks = document.querySelectorAll('.left-content nav a.nav-link');
    const defaultFile = 'about.html'; 

    // --- UTILITY FUNCTIONS ---

    function removeActiveClasses() {
        navLinks.forEach(link => link.classList.remove('active'));
    }

    // Function to load content dynamically
    async function loadContent(fileName) {
        try {
            // Fetch the HTML content
            const response = await fetch(fileName);
            if (!response.ok) {
                throw new Error(`Failed to load content file: ${fileName}`);
            }
            const htmlContent = await response.text();

            // Insert the HTML into the right column
            rightColumn.innerHTML = htmlContent;
            rightColumn.scrollTop = 0; // Scroll to top of new content

            // After loading, re-attach event listeners for the gallery
            attachGalleryTriggers(); 

        } catch (error) {
            console.error('Content loading error:', error);
            rightColumn.innerHTML = `<h2>Error</h2><p>Could not load content for ${fileName}. Please ensure <code>${fileName}</code> exists in the same directory.</p>`;
        }
    }

    // --- NAV LINK CLICK HANDLER ---

    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();

            // Get the file name from the data attribute
            const contentFile = this.getAttribute('data-content-file');
            if (contentFile) {
                // Load the new content
                loadContent(contentFile);
                
                // Update active class
                removeActiveClasses();
                this.classList.add('active');
            }
        });
    });

    // --- INITIAL LOAD ---

    // Find the link corresponding to the default file and click it
    const initialLink = document.querySelector(`a[data-content-file="${defaultFile}"]`);
    if (initialLink) {
        initialLink.click();
    }


    // ----------------------------------------------------
    // --- GALLERY POPUP (Modified to attach after load) ---
    // ----------------------------------------------------
    
    let currentGallery = [];
    let currentIndex = 0;
    let keyboardListenerAdded = false; // Flag to ensure keyboard listener is only added once

    function clearMedia(popup) {
        popup.querySelectorAll('img, video').forEach(el => {
            if (el.tagName && el.tagName.toLowerCase() === 'video') {
                try { el.pause(); } catch (err) {}
                el.removeAttribute('src');
            }
            el.remove();
        });
    }

    function showMedia(popup, prevBtn, nextBtn, index) {
        clearMedia(popup);
        const src = currentGallery[index];
        if (!src) return;

        const isVideo = src.match(/\.(mp4|webm)(\?.*)?$/i);
        const insertionPoint = nextBtn; 

        if (isVideo) {
            const video = document.createElement('video');
            video.src = src;
            video.controls = true;
            video.autoplay = true;
            video.muted = true;
            video.loop = true;
            video.playsInline = true;
            video.style.maxWidth = '100%';
            video.style.maxHeight = '100%';
            video.setAttribute('aria-label', 'Gallery video');
            popup.insertBefore(video, insertionPoint);

            video.addEventListener('error', (ev) => console.warn('Video error', ev));
            video.play().catch(err => {
                console.warn('Play promise rejected:', err);
            });
        } else {
            const img = document.createElement('img');
            img.src = src;
            img.alt = 'Gallery image';
            img.style.maxWidth = '100%';
            img.style.maxHeight = '100%';
            popup.insertBefore(img, insertionPoint);
        }
    }
    
    function attachGalleryTriggers() {
        const popup = document.getElementById('columnPopup');
        if (!popup) return; 

        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        
        // ATTACH TRIGGER EVENT
        const galleryTriggerHandler = function(e) {
             e.preventDefault();
             currentGallery = e.currentTarget.dataset.images.split(',').map(x => x.trim()).filter(x => x.length);
             currentIndex = 0;
             showMedia(popup, prevBtn, nextBtn, currentIndex);
             popup.style.display = 'flex';
        };

        // Attach event listener only to elements in the newly loaded content
        document.querySelectorAll('.gallery-trigger').forEach(item => {
            // Clear old listeners before attaching new ones
            item.removeEventListener('click', galleryTriggerHandler);
            item.addEventListener('click', galleryTriggerHandler);
        });
        
        // ATTACH NAV BUTTON EVENTS (Using property assignment to prevent duplicates)
        nextBtn.onclick = (e) => {
            e.stopPropagation();
            if (!currentGallery.length) return;
            currentIndex = (currentIndex + 1) % currentGallery.length;
            showMedia(popup, prevBtn, nextBtn, currentIndex);
        };

        prevBtn.onclick = (e) => {
            e.stopPropagation();
            if (!currentGallery.length) return;
            currentIndex = (currentIndex - 1 + currentGallery.length) % currentGallery.length;
            showMedia(popup, prevBtn, nextBtn, currentIndex);
        };

        // ATTACH CLOSE EVENT
        popup.onclick = (e) => {
            if (e.target === popup) {
                popup.style.display = 'none';
                const vid = popup.querySelector('video');
                if (vid) vid.pause();
                clearMedia(popup); 
            }
        };

        // ATTACH KEYBOARD EVENTS (Ensure only one listener on the document)
        if (!keyboardListenerAdded) {
            document.addEventListener('keydown', keyboardHandler);
            keyboardListenerAdded = true;
        }
    }
    
    // KeyDown Handler Definition
    function keyboardHandler(e) {
        const popup = document.getElementById('columnPopup');
        if (popup && popup.style.display === 'flex') {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (e.key === 'Escape') {
                popup.querySelectorAll('video').forEach(v => { try { v.pause(); } catch (err) {} });
                popup.style.display = 'none';
                clearMedia(popup);
            }
            if (e.key === 'ArrowRight' && nextBtn) nextBtn.click();
            if (e.key === 'ArrowLeft' && prevBtn) prevBtn.click();
        }
    }
    
    // --- Disable right-click on the entire page --- 
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        alert("Right-click is disabled on this page.");
    });
});
</script>

</body>
</html>
